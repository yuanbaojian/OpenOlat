(function(){tinymce.create("org.olat.core.gui.components.form.flexible.impl.elements.richText.plugins.quotespliter",{init:function(a,b){a.on("KeyDown",function(f){if(f==null||f.keyCode!=13||!a.selection.isCollapsed()){return}var c=a.selection.getNode();if(c==null){return}if(g(c)){tinymce.dom.Event.cancel(f);d(c)}function g(e){var i=a.dom.getParent(e,"DIV");var h=a.dom.getParent(e,"BLOCKQUOTE");if(i&&h&&(i.className=="b_quote_wrapper"||i.className=="o_quote_wrapper")){return true}return false}function d(n){var o=a.dom.getParents(n);var r="";var h="";for(var m=0;m<o.length;m++){var p=o[m];r+="</"+p.nodeName+">";if(p.className=="b_quote_wrapper"||p.className=="o_quote_wrapper"){var q='<div class="o_quote_wrapper"><div class="o_quote_author mceNonEditable">';for(var k=0;k<p.childNodes.length;k++){if(p.childNodes[k].className=="o_quote_author mceNonEditable"||p.childNodes[k].className=="b_quote_author mceNonEditable"){q+=p.childNodes[k].innerHTML;break}}h=q+"</div>"+h;if(!g(p)){break}}else{h="<"+p.nodeName+' class="'+p.className+'">'+h}}var e=r+'<p><span id="quote_spliter_marker"></span><br/></p>'+h;a.execCommand("mceInsertRawHTML",true,e);var l=a.dom.get("quote_spliter_marker");if(l){a.selection.select(l);a.selection.collapse();a.execCommand("mceRemoveNode",true,l)}}})},getInfo:function(){return{longname:"Olat Quote Spliter",author:"frentix GmbH",authorurl:"http://www.frentix.com",infourl:"http://www.frentix.com",version:"1.1.1"}}});tinymce.PluginManager.add("quotespliter",org.olat.core.gui.components.form.flexible.impl.elements.richText.plugins.quotespliter)})();